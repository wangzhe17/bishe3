function A=thinner(AM)
[w,h]=size(AM);
for i=2:w-1
    for j=2:h-1
        B=AM(i-1:i+1,j-1:j+1);
        if B(2,2)==1 && sum(B(:))==3
            if B(2,1)==1&&B(2,2)==1&&B(1,2)==1
                B(2,2)=0;
                AM(i-1:i+1,j-1:j+1)=B;
            end
        end
        if B(2,2)==1 && sum(B(:))==3
            if B(1,2)==1&&B(2,2)==1&&B(2,3)
                B(2,2)=0;
                AM(i-1:i+1,j-1:j+1)=B;
            end
        end
        if B(2,2)==1 && sum(B(:))==3
            if B(2,1)==1&&B(2,2)==1&&B(3,2)
                B(2,2)=0;
                AM(i-1:i+1,j-1:j+1)=B;
            end
        end
        if B(2,2)==1 && sum(B(:))==3
            if B(3,2)==1&&B(2,2)==1&&B(2,3)==1
                B(2,2)=0;
                AM(i-1:i+1,j-1:j+1)=B;
            end
        end
        if B(2,2)==1 && sum(B(:))==4
            if B(1,2)==1&&B(2,2)==1&&B(2,3)==1&&B(3,3)==1
                B(2,2)=0;
                AM(i-1:i+1,j-1:j+1)=B;
            end
        end
        if B(2,2)==1 && sum(B(:))==4
            if B(1,2)==1&&B(2,1)==1&&B(2,2)==1&&B(3,1)==1
                B(2,1)=0;
                AM(i-1:i+1,j-1:j+1)=B;
            end
        end
        if B(2,2)==1 && sum(B(:))==4
            if B(1,2)==1&&B(1,3)==1&&B(2,1)==1&&B(2,2)==1
                B(2,2)=0;
                AM(i-1:i+1,j-1:j+1)=B;
            end
        end
        if B(2,2)==1 && sum(B(:))==5
            if B(1,2)==1&&B(1,3)==1&&B(2,1)==1&&B(2,2)==1&&B(3,2)==1
                B(1,2)=0;
                AM(i-1:i+1,j-1:j+1)=B;
            end
        end
        if B(2,2)==1 && sum(B(:))==5
            if B(1,1)==1&&B(1,2)==1&&B(2,2)==1&&B(2,3)==1&&B(3,2)==1
                B(1,2)=0;
                AM(i-1:i+1,j-1:j+1)=B;
            end
        end
    end
end

A=AM;